<!DOCTYPE html>
<html lang="fa">
<head>
    <title>تأیید OTP</title>
</head>
<body>
    <h1>تأیید کد OTP</h1>
    <p>یک کد ۶ رقمی به ایمیل شما ارسال شده است. لطفاً آن را وارد کنید.</p>

    <form id="verifyOtpForm">
        <input type="text" id="otp" placeholder="کد ۶ رقمی"><br>
        <button type="submit">تأیید</button>
    </form>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const email = urlParams.get('email');

        document.getElementById("verifyOtpForm").onsubmit = function(e) {
            e.preventDefault();
            fetch("http://127.0.0.1:8000/account/login-otp/", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email: email, otp: document.getElementById("otp").value })
            })
            .then(response => response.json())
            .then(data => {
                if (data.message) {
                    alert(data.message);
                    window.location.href = 'dashboard.html';  // انتقال به داشبورد
                } else {
                    alert("خطا: " + data.error);
                }
            });
        };
    </script>
</body>
</html>
